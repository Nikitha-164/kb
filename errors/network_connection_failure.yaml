kb_metadata:
  version: 1.0.0
  status: ACTIVE
  last_reviewed: 2024-06-05
error_type: NetworkConnectionFailure
error_scope: AWS::Glue::Job
category: NETWORK
severity: MEDIUM

description: >
  The job fails to reach external systems due to missing/incorrect connection settings.

possible_causes:
  - Missing Glue connection
  - Wrong VPC/subnet/security group on job
  - JDBC endpoint unreachable or wrong port

safe_fixes:
  - fix_id: ATTACH_GLUE_CONNECTION
    title: Attach Glue connection to job
    description: Attach a pre-approved Glue connection for the target system
    requires_live_checks: [glue_connection_exists, job_missing_connection]
    allowed_service_actions: [glue:UpdateJob]
    resource_constraints:
      resource_type: glue_connection
    risk_level: MEDIUM

  - fix_id: UPDATE_VPC_CONFIG
    title: Update job VPC configuration
    description: Adjust VPC/subnet/SG to match the approved connection profile
    requires_live_checks: [approved_vpc_profile_available]
    allowed_service_actions: [glue:UpdateJob]
    resource_constraints:
      resource_type: job_network_profile
    risk_level: HIGH

constraints:
  must_not_grant_wildcard_resource: true
  max_policy_statements_added: 0

automation_policy:
  auto_remediation_allowed: true
  human_approval_required_for: [risk_level: HIGH]

audit_metadata:
  owner_team: data-platform
  compliance_tags: [network, glue]